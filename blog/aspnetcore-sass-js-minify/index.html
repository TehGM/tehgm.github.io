<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Compiling SASS and minifying JS and CSS with ASP.NET Core - TehGM's Blog</title><meta name=Description content="How to automate compiling SASS and also minifying JS and CSS in your ASP.NET Core project"><meta property="og:title" content="Compiling SASS and minifying JS and CSS with ASP.NET Core"><meta property="og:description" content="How to automate compiling SASS and also minifying JS and CSS in your ASP.NET Core project"><meta property="og:type" content="article"><meta property="og:url" content="https://tehgm.net/blog/aspnetcore-sass-js-minify/"><meta property="og:image" content="https://tehgm.net/img/tehgm_avatar.png"><meta property="article:published_time" content="2021-03-25T13:10:21+01:00"><meta property="article:modified_time" content="2021-03-25T14:02:21+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tehgm.net/img/tehgm_avatar.png"><meta name=twitter:title content="Compiling SASS and minifying JS and CSS with ASP.NET Core"><meta name=twitter:description content="How to automate compiling SASS and also minifying JS and CSS in your ASP.NET Core project"><meta name=application-name content="TehGM"><meta name=apple-mobile-web-app-title content="TehGM"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://tehgm.net/blog/aspnetcore-sass-js-minify/><link rel=prev href=https://tehgm.net/blog/nuget-github-actions/><link rel=next href=https://tehgm.net/blog/stalker-anomaly-modpack/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Compiling SASS and minifying JS and CSS with ASP.NET Core","inLanguage":"en-gb","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/tehgm.net\/blog\/aspnetcore-sass-js-minify\/"},"image":["https:\/\/tehgm.net\/img\/tehgm_avatar.png"],"genre":"blog","keywords":"guide, dev, web","wordcount":2158,"url":"https:\/\/tehgm.net\/blog\/aspnetcore-sass-js-minify\/","datePublished":"2021-03-25T13:10:21+01:00","dateModified":"2021-03-25T14:02:21+01:00","publisher":{"@type":"Organization","name":"TehGM"},"author":{"@type":"Person","name":"TehGM"},"description":"How to automate compiling SASS and also minifying JS and CSS in your ASP.NET Core project"}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=TehGM><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/ title=Home>Home </a><a class=menu-item href=/blog/ title=Blog>Blog </a><a class=menu-item href=/blog/imo/ title="Blog: IMO">IMO </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=TehGM><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/ title=Home>Home</a><a class=menu-item href=/blog/ title=Blog>Blog</a><a class=menu-item href=/blog/imo/ title="Blog: IMO">IMO</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Compiling SASS and minifying JS and CSS with ASP.NET Core</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://tehgm.net title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>TehGM</a></span>&nbsp;<span class=post-category>included in <a href=/blog/categories/technology/><i class="far fa-folder fa-fw"></i>Technology</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=25.03.2021>25.03.2021</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2158 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;11 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#what-is-sass>What is SASS</a></li><li><a href=#what-is-minifying>What is Minifying</a></li><li><a href=#doing-it-in-aspnet-core>Doing it in ASP.NET Core</a><ul><li><a href=#project-preparation>Project preparation</a></li><li><a href=#webcompiler>WebCompiler</a></li><li><a href=#using-the-minified-files>Using the minified files</a></li></ul></li><li><a href=#excluding-from-git>Excluding from git</a></li><li><a href=#automating-the-process>Automating the Process</a><ul><li></li><li><a href=#integrating-with-cicd>Integrating with CI/CD</a></li></ul></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><p>When working on my Link Shortener (coming soon!) project, I decided that using normal CSS is tedious, so I wanted to use SASS. But I didn&rsquo;t want to compile it manually, so I ventured onto finding the solution that is ideal for me, and is easy to add at once - much easier than other tutorials I found online.</p><h2 id=what-is-sass>What is SASS</h2><p><a href=https://sass-lang.com/ target=_blank rel="noopener noreffer">SASS</a> (Syntatically Awesome Style Sheets) is an extension language for CSS, that aims to extend CSS with features like inheritance, nesting, multi-file modules or even maths - making CSS much less dreadful at once. Considering how annoying and unmaintainable CSS can get, it makes SASS one of the best ways to style your website.</p><p>Unfortunately, SASS has one significant issue - it is not natively supported by browsers. This means it needs to be converted (&ldquo;compiled&rdquo;) to CSS before publishing your website.</p><h2 id=what-is-minifying>What is Minifying</h2><p>Ideally your code and markup should be as readable and expressive as possible. Variable names should be self-explaining, code lines should be separated, <code>{</code> and <code>}</code> brackets should be on new line (depending on your language&rsquo;s code style) etc. These rules should be followed as they increase maintainability, helps with debugging and makes working with the project <em>much</em> less painful.</p><p>Unfortunately such approach means more letters. More letters means more bytes. And more bytes to transfer is not good for websites (or your visitors&rsquo; experience). For that reason it is recommended to &ldquo;minify&rdquo; your CSS and JS files.</p><p>Minifying process essentially converts your neat and highly readable files into obfuscated and ugly but much smaller <code>.min.css</code> and <code>.min.js</code> files. Your old files stay intact as minified files are created in addition to your well-formatted files - your website simply instructs browsers to download the minified files instead of normal files, reducing network traffic.</p><h2 id=doing-it-in-aspnet-core>Doing it in ASP.NET Core</h2><p>ASP.NET Core projects do not support SASS or minifying out of the box. But as you can see, both have huge benefits - so let&rsquo;s make our project support them both.</p><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw"></i>Note: Other tutorials<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>You can find numerous tutorials for SASS and minifying in ASP.NET Core, however I found each of these tutorials less than perfect - they usually resort to using NodeJS or using obsolete/abandoned tools.<br>For this reason I did my research and found the approach that works for me, and is also quite simple to follow. Read on!</div></div></div><h3 id=project-preparation>Project preparation</h3><p>First, let&rsquo;s do some preparation of our project itself - don&rsquo;t worry, there isn&rsquo;t much to change!</p><p>This guide assumes that your project has <code>wwwroot</code> directory, that contains <code>css</code> and <code>js</code> directories. It&rsquo;s okay if it doesn&rsquo;t - but you&rsquo;ll need to make the changes as you follow the steps accordingly. Default ASP.NET Core projects might also create <code>wwwroot/lib</code> directory, but it&rsquo;s okay - we&rsquo;ll make our process ignore them.</p><p>What you need to do is rename your <code>site.css</code> file into <code>site.scss</code>. The exact file name might be different for you, the important thing is that we change <code>.css</code> extension into <code>.scss</code>. A valid CSS file will also be automatically a valid SASS file, so you can do it without worry - it will just work.</p><a class=lightgallery href=/blog/aspnetcore-sass-js-minify/project-structure-1.png title="Project Structure (Before)" data-thumbnail=/blog/aspnetcore-sass-js-minify/project-structure-1.png><img class=lazyload src=/svg/loading.min.svg data-src=project-structure-1.png data-srcset="/blog/aspnetcore-sass-js-minify/project-structure-1.png, project-structure-1.png 1.5x, /blog/aspnetcore-sass-js-minify/project-structure-1.png 2x" data-sizes=auto alt="Project Structure (Before)"></a><h3 id=webcompiler>WebCompiler</h3><p>Now we need a tool. Some tutorials I found suggest using Mads Kristensen&rsquo;s <a href=https://github.com/madskristensen/WebCompiler target=_blank rel="noopener noreffer">WebCompiler</a>. Unfortunately this tool seems to be abandoned and not worked on anymore. ðŸ˜ž<br>Luckily other programmers stepped in - one of them being <em>excubo-ag</em> with their own great version of <a href=https://github.com/excubo-ag/WebCompiler target=_blank rel="noopener noreffer">WebCompiler</a>. As of date of this post, it is still actively supported and works perfectly well, so let&rsquo;s install it! The project&rsquo;s <a href=https://github.com/excubo-ag/WebCompiler#getting-started target=_blank rel="noopener noreffer">README</a> explains ways to install, but for the sake of this tutorial, let&rsquo;s go with global installation method:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>dotnet tool install Excubo.WebCompiler --global</code></pre></td></tr></table></div></div></p><p>Next step is to create a configuration file. This is actually optional, but it is always useful to be able to customize the process if you want to. Navigate to your project&rsquo;s directory, and run following command:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>webcompiler --defaults webcompiler.json</code></pre></td></tr></table></div></div></p><p>This command will create a new <code>webcompiler.json</code> file with default configuration. Feel free to customize it as you see fit! I personally set <code>GZip</code> to false, but you&rsquo;re welcome to do anything that fits your needs.</p><p>Now your can run webcompiler in your project&rsquo;s directory using 2 commands:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh>webcompiler -r wwwroot/css -c webcomplier.json
webcompiler -r wwwroot/js -c webcompiler.json</code></pre></td></tr></table></div></div></p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Tip<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>You could technically run just one command <code>webcompiler -r wwwroot -c webcompiler.json</code>. The reason why I run 2 more explicit ones is that my project has a <code>wwwroot/lib</code> directory that I don&rsquo;t want WebCompiler to touch. If you don&rsquo;t have it (or simply don&rsquo;t mind) you can run just one command in this and all of the following examples.</div></div></div><p>Once the commands execute successfully, the project will now have additional files:
<a class=lightgallery href=/blog/aspnetcore-sass-js-minify/project-structure-2.png title="Project Structure (After)" data-thumbnail=/blog/aspnetcore-sass-js-minify/project-structure-2.png><img class=lazyload src=/svg/loading.min.svg data-src=project-structure-2.png data-srcset="/blog/aspnetcore-sass-js-minify/project-structure-2.png, project-structure-2.png 1.5x, /blog/aspnetcore-sass-js-minify/project-structure-2.png 2x" data-sizes=auto alt="Project Structure (After)"></a></p><h3 id=using-the-minified-files>Using the minified files</h3><p>Now we just need to make our website actually use the minified files. To do so, go to the location where your project references your CSS and JS files. This location might vary depending on the project type and any modifications made to it. In case of Razor Pages, the files are referenced in <code>Pages/Shared/_Layout.cshtml</code> by default. There you can simply change extensions of references CSS and JS files from <code>.css</code> and <code>.js</code> to <code>.min.css</code> and <code>.min.js</code>, respectively.</p><p>If you now run the project, enter browser dev tools (<code>F12</code> for me), go to Network tab, and force refresh the website using (<code>Ctrl+F5</code> for me), you should now see that <code>.min.css</code> and <code>.min.js</code> files are being loaded, but the website still looks nice. Great!
<a class=lightgallery href=/blog/aspnetcore-sass-js-minify/minified-files-1.png title="Minified files being loaded" data-thumbnail=/blog/aspnetcore-sass-js-minify/minified-files-1.png><img class=lazyload src=/svg/loading.min.svg data-src=minified-files-1.png data-srcset="/blog/aspnetcore-sass-js-minify/minified-files-1.png, minified-files-1.png 1.5x, /blog/aspnetcore-sass-js-minify/minified-files-1.png 2x" data-sizes=auto alt="Minified files being loaded"></a></p><h4 id=non-minified-for-debugging>Non-minified for Debugging</h4><p>This should be enough to make our website use minified files, but we can go a step further. Debugging non-minified files is much easier, so why don&rsquo;t we make our project use non-minified versions when we&rsquo;re running in Development environment?</p><p>To do this, we first need to inject <code>IWebHostEnvironment</code> service to our file. You can do it in the same file that is referencing the CSS and JS files, or you can do it in your shared imports file (in Razor Pages: <code>Pages/_ViewImports.cshtml</code>). I personally chose to use the latter so this service is accessible in all of my pages, but the code we need to add is the same - simply add following line somewhere at the beginning of your chosen file:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html>@inject Microsoft.AspNetCore.Hosting.IWebHostEnvironment HostEnvironment</code></pre></td></tr></table></div></div></p><p>Great, now you can use <code>HostEnvironment</code> in your file, so you can check the environment using Razor C# syntax. The idea is simple - if environment is Development, then reference non-minified files, otherwise use minified ones. Example from my Link Shortener project:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-html data-lang=html>@* Use full versions in non-dev, but minified in dev *@
@if (HostEnvironment.IsDevelopment())
{
    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;~/lib/bootstrap/dist/css/bootstrap.css&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;~/css/site.css&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/lib/jquery/dist/jquery.js&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/lib/bootstrap/dist/js/bootstrap.bundle.js&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/js/site.js&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
}
else
{
    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;~/lib/bootstrap/dist/css/bootstrap.min.css&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;</span><span class=nt>link</span> <span class=na>rel</span><span class=o>=</span><span class=s>&#34;stylesheet&#34;</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;~/css/site.min.css&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/lib/jquery/dist/jquery.min.js&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/lib/bootstrap/dist/js/bootstrap.bundle.min.js&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/js/site.min.js&#34;</span> <span class=na>asp-append-version</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;text/javascript&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
}</code></pre></td></tr></table></div></div></p><p>Lastly, to ensure that project runs in Development environment when ran through Visual Studio, it might be worth adding <code>ASPNETCORE_ENVIRONMENT</code> environment variable in your Project Debug settings. To do so, make following changes in your <code>launchSettings.json</code> file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=hl><span class=lnt>14
</span></span><span class=hl><span class=lnt>15
</span></span><span class=hl><span class=lnt>16
</span></span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=hl><span class=lnt>22
</span></span><span class=hl><span class=lnt>23
</span></span><span class=hl><span class=lnt>24
</span></span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
  <span class=nt>&#34;iisSettings&#34;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&#34;windowsAuthentication&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
    <span class=nt>&#34;anonymousAuthentication&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
    <span class=nt>&#34;iisExpress&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;applicationUrl&#34;</span><span class=p>:</span> <span class=s2>&#34;http://localhost:7935&#34;</span><span class=p>,</span>
      <span class=nt>&#34;sslPort&#34;</span><span class=p>:</span> <span class=mi>0</span>
    <span class=p>}</span>
  <span class=p>},</span>
  <span class=nt>&#34;profiles&#34;</span><span class=p>:</span> <span class=p>{</span>
    <span class=nt>&#34;IIS Express&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;commandName&#34;</span><span class=p>:</span> <span class=s2>&#34;IISExpress&#34;</span><span class=p>,</span>
      <span class=nt>&#34;launchBrowser&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
<span class=hl>      <span class=nt>&#34;environmentVariables&#34;</span><span class=p>:</span> <span class=p>{</span>
</span><span class=hl>        <span class=nt>&#34;ASPNETCORE_ENVIRONMENT&#34;</span><span class=p>:</span> <span class=s2>&#34;Development&#34;</span>
</span><span class=hl>      <span class=p>}</span>
</span>    <span class=p>},</span>
    <span class=nt>&#34;LinkShortener&#34;</span><span class=p>:</span> <span class=p>{</span>
      <span class=nt>&#34;commandName&#34;</span><span class=p>:</span> <span class=s2>&#34;Project&#34;</span><span class=p>,</span>
      <span class=nt>&#34;launchBrowser&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nt>&#34;applicationUrl&#34;</span><span class=p>:</span> <span class=s2>&#34;http://localhost:7935&#34;</span><span class=p>,</span>
<span class=hl>      <span class=nt>&#34;environmentVariables&#34;</span><span class=p>:</span> <span class=p>{</span>
</span><span class=hl>        <span class=nt>&#34;ASPNETCORE_ENVIRONMENT&#34;</span><span class=p>:</span> <span class=s2>&#34;Development&#34;</span>
</span><span class=hl>      <span class=p>}</span>
</span>    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span></code></pre></td></tr></table></div></div><p>If you do not have <code>launchSettings.json</code> file, you can also add variables using VS menus. Go to <em><strong>Project -> <project>Properties -> Debug</strong></em> and add a new variable there.
<a class=lightgallery href=/blog/aspnetcore-sass-js-minify/project-env-variables-1.png title="Project Environment Variables" data-thumbnail=/blog/aspnetcore-sass-js-minify/project-env-variables-1.png><img class=lazyload src=/svg/loading.min.svg data-src=project-env-variables-1.png data-srcset="/blog/aspnetcore-sass-js-minify/project-env-variables-1.png, project-env-variables-1.png 1.5x, /blog/aspnetcore-sass-js-minify/project-env-variables-1.png 2x" data-sizes=auto alt="Project Environment Variables"></a></p><h2 id=excluding-from-git>Excluding from git</h2><p>From now on you&rsquo;ll be working exclusively on <code>.scss</code> and <code>.js</code> files. However, git by default will still include them in your repository. They are not needed there, since they&rsquo;re generated by a tool (which we&rsquo;ll fully automate in a moment). For that reason, it might want to exclude CSS and minified files from the repository.</p><p>To do so, edit <code>.gitignore</code> file at the root directory of your repository (if it doesn&rsquo;t exist, simply create it) and add following lines to the file:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sh data-lang=sh><span class=c1># WebCompiler outputs</span>
*/wwwroot/css/site.css
*/wwwroot/css/**.min.css
*/wwwroot/js/**.min.js</code></pre></td></tr></table></div></div></p><p>The above snippet will ignore all minified CSS and JS files, and <code>site.css</code> specifically. You might also ignore all <code>**.css</code> files, but I chose not to in case I want to use non-SASS CSS for some specific file at some point.</p><h2 id=automating-the-process>Automating the Process</h2><p>So we now have a full support of SASS and minifying in our project, which is great. However running these commands manually on every change is annoying. <a href=https://github.com/excubo-ag/WebCompiler#build-integrations target=_blank rel="noopener noreffer">Excubo.WebCompiler&rsquo;s README</a> suggests modifying your <code>.csproj</code> to run webcompiler on every build - in our guide, the modification would look as follows:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;Target</span> <span class=na>Name=</span><span class=s>&#34;CompileStaticAssets&#34;</span> <span class=na>AfterTargets=</span><span class=s>&#34;AfterBuild&#34;</span><span class=nt>&gt;</span>
  <span class=nt>&lt;Exec</span> <span class=na>Command=</span><span class=s>&#34;webcompiler -r wwwroot/css -c webcompiler.json&#34;</span> <span class=na>StandardOutputImportance=</span><span class=s>&#34;high&#34;</span> <span class=nt>/&gt;</span>
  <span class=nt>&lt;Exec</span> <span class=na>Command=</span><span class=s>&#34;webcompiler -r wwwroot/js -c webcompiler.json&#34;</span> <span class=na>StandardOutputImportance=</span><span class=s>&#34;high&#34;</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/Target&gt;</span></code></pre></td></tr></table></div></div></p><p>Now that&rsquo;s a huge improvement over manually triggering the commands, and would even work with CI/CD pipelines. Unfortunately this approach has one major issue: when you run the project via Visual Studio and none of the non-static files has changed, it will not rebuild the project - so WebCompiler will not run! You could manually trigger full rebuild whenever you change CSS/JS, but that&rsquo;d be really annoying.<br>The answer to that issue is using a file watcher. Unfortunately I had issue getting <code>dotnet watch</code> to work with webcompiler, and I also didn&rsquo;t want to keep batch files or typing command every time I start working on my project again. For that reason I created a tool called <em><strong>fsriev</strong></em>.</p><h5 id=fsriev>fsriev</h5><p><em>fsriev</em> is a .NET Core-based file watcher for Windows and Linux. It is designed to be fairly customizable, can watch multiple directories at once, run multiple commands on a file change, and supports exclusion filters. It also uses <a href="https://docs.microsoft.com/en-gb/aspnet/core/fundamentals/configuration/?view=aspnetcore-5.0" target=_blank rel="noopener noreffer">Microsoft.Extensions.Configuration</a>, which means that it can be configured in a large variety of ways. The recommended way is to use the config file - once it is configured, you can simply add shortcut to <code>fsriev.exe</code> to your Desktop or Start menu and run it with a single button click!</p><p>So, let&rsquo;s download the latest version of <em>fsriev</em> <a href=https://github.com/TehGM/fsriev/releases/ target=_blank rel="noopener noreffer">from here</a>. If you have <a href=https://dotnet.microsoft.com/download/dotnet/5.0 target=_blank rel="noopener noreffer">.NET 5 Runtime</a> installed, download portable version - otherwise download one of OS-specific packages. Once download is completed, extract the zip package to the location where you want to keep <em>fsriev</em> &ldquo;installed&rdquo;.<br>Once extracted, we need to edit the config file - so open <code>appsettings.json</code> with your text editor. <em>fsriev</em> configuration is documented in its <a href=https://github.com/TehGM/fsriev#configuration target=_blank rel="noopener noreffer">README</a>. In this guide, the configuration I use for my Link Shortener project will serve us an example:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-json data-lang=json><span class=p>{</span>
  <span class=nt>&#34;Watchers&#34;</span><span class=p>:</span> <span class=p>[</span>
    <span class=p>{</span>
      <span class=nt>&#34;Name&#34;</span><span class=p>:</span> <span class=s2>&#34;LinkShortener&#34;</span><span class=p>,</span>
      <span class=nt>&#34;Enabled&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nt>&#34;FolderPath&#34;</span><span class=p>:</span> <span class=s2>&#34;D:\\Dev\\C#\\LinkShortener\\LinkShortener\\wwwroot&#34;</span><span class=p>,</span>
      <span class=nt>&#34;FileFilters&#34;</span><span class=p>:</span> <span class=p>[</span>
        <span class=s2>&#34;*.scss&#34;</span><span class=p>,</span>
        <span class=s2>&#34;*.js&#34;</span>
      <span class=p>],</span>
      <span class=nt>&#34;Recursive&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nt>&#34;SkipWhenBusy&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
      <span class=nt>&#34;NotifyFilters&#34;</span><span class=p>:</span> <span class=s2>&#34;LastWrite,FileName&#34;</span><span class=p>,</span>
      <span class=nt>&#34;Exclusions&#34;</span><span class=p>:</span> <span class=p>[</span>
        <span class=s2>&#34;*.min.*&#34;</span><span class=p>,</span>
        <span class=s2>&#34;*~*.tmp&#34;</span>
      <span class=p>],</span>
      <span class=nt>&#34;WorkingDirectory&#34;</span><span class=p>:</span> <span class=s2>&#34;D:\\Dev\\C#\\LinkShortener\\LinkShortener&#34;</span><span class=p>,</span>
      <span class=nt>&#34;Commands&#34;</span><span class=p>:</span> <span class=p>[</span>
        <span class=s2>&#34;webcompiler -r wwwroot/css -c webcompiler.json&#34;</span><span class=p>,</span>
        <span class=s2>&#34;webcompiler -r wwwroot/js -c webcompiler.json&#34;</span>
      <span class=p>]</span>
    <span class=p>}</span>
  <span class=p>]</span>
<span class=p>}</span></code></pre></td></tr></table></div></div></p><p>Once done with the configuration, save the file and run <em>fsriev</em>. Once it&rsquo;s running (and no errors are displayed), go to your SASS or JS file, and make any change, and then save the file. <strong>fsriev</strong> should automatically run the commands for you:
<a class=lightgallery href=/blog/aspnetcore-sass-js-minify/automating-1.png title="Automated Process with fsriev" data-thumbnail=/blog/aspnetcore-sass-js-minify/automating-1.png><img class=lazyload src=/svg/loading.min.svg data-src=automating-1.png data-srcset="/blog/aspnetcore-sass-js-minify/automating-1.png, automating-1.png 1.5x, /blog/aspnetcore-sass-js-minify/automating-1.png 2x" data-sizes=auto alt="Automated Process with fsriev"></a></p><p>Now as long a fsriev is running, whenever you make any change to your SASS or JS file, all you need to do is restart the project, without having to worry about compiling SASS or minifying CSS and JS.</p><h3 id=integrating-with-cicd>Integrating with CI/CD</h3><p>If you&rsquo;re using a build pipeline like GitHub Actions or Azure DevOps Pipelines, there&rsquo;s a few more steps needed. But don&rsquo;t worry, they&rsquo;re simple!</p><p>If you installed <a href=https://github.com/excubo-ag/WebCompiler target=_blank rel="noopener noreffer">Excubo.WebCompiler</a> globally, you need a task to run a command to install it before running build task of your pipeline.<br>If you didn&rsquo;t edit your <code>.csproj</code> file to run WebCompiler on build, you also need a task that runs <code>webcompiler -r YourProject/wwwroot/css -c YourProject/webcompiler.json</code> and <code>webcompiler -r YourProject/wwwroot/js -c YourProject/webcompiler.json</code>.</p><p>Once these commands are run, you can proceed with with building the project. You can also add a task to remove any <code>.scss</code> file before publishing, but that&rsquo;s completely optional.</p><h2 id=summary>Summary</h2><p>I hope this guide shows the easiest way to automate SASS compilation and CSS and JS minification in your ASP.NET Core project. This is the approach I found to be the easiest (well, besides the need to create <em>fsriev</em> - but you won&rsquo;t need to do that!), and I use it myself.</p><p>If I find any improvements or errors, I&rsquo;ll update this guide accordingly. I&rsquo;ll also do so if <em>fsriev</em> changes any significantly - and I&rsquo;ll be aware of it, as it&rsquo;s a tool I made myself.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 25.03.2021</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/ data-title="Compiling SASS and minifying JS and CSS with ASP.NET Core" data-via=TehOriginalGM data-hashtags=guide,dev,web><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/ data-hashtag=guide><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/ data-title="Compiling SASS and minifying JS and CSS with ASP.NET Core" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Tumblr" data-sharer=tumblr data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/ data-title="Compiling SASS and minifying JS and CSS with ASP.NET Core" data-caption="How to automate compiling SASS and also minifying JS and CSS in your ASP.NET Core project" data-tags=guide,dev,web><i class="fab fa-tumblr fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/ data-title="Compiling SASS and minifying JS and CSS with ASP.NET Core"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on Myspace" data-sharer=myspace data-url=https://tehgm.net/blog/aspnetcore-sass-js-minify/ data-title="Compiling SASS and minifying JS and CSS with ASP.NET Core" data-description="How to automate compiling SASS and also minifying JS and CSS in your ASP.NET Core project"><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/blog/tags/guide/>guide</a>,&nbsp;<a href=/blog/tags/dev/>dev</a>,&nbsp;<a href=/blog/tags/web/>web</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/blog/nuget-github-actions/ class=prev rel=prev title="Publishing NuGet packages with GitHub Actions"><i class="fas fa-angle-left fa-fw"></i>Publishing NuGet packages with GitHub Actions</a>
<a href=/blog/stalker-anomaly-modpack/ class=next rel=next title="TehGM's Stalker Anomaly Modpack">TehGM's Stalker Anomaly Modpack<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2020 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://tehgm.net>TehGM</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=https://code.jquery.com/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/spoiler.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":35},"comment":{},"data":{"id-1":"TehGM","id-2":"TehGM"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"typeit":{"cursorChar":null,"cursorSpeed":null,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":null,"speed":null}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>