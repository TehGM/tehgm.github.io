<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>DocFX automation with GitHub Actions - TehGM's Blog</title><meta name=Description content="Let me show you how to automate publishing a DocFX documentation page using GitHub Actions"><meta property="og:title" content="DocFX automation with GitHub Actions"><meta property="og:description" content="Let me show you how to automate publishing a DocFX documentation page using GitHub Actions"><meta property="og:type" content="article"><meta property="og:url" content="https://tehgm.net/blog/docfx-github-actions/"><meta property="og:image" content="https://tehgm.net/img/tehgm_avatar.png"><meta property="article:published_time" content="2020-12-18T17:44:02+01:00"><meta property="article:modified_time" content="2020-12-18T17:44:02+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tehgm.net/img/tehgm_avatar.png"><meta name=twitter:title content="DocFX automation with GitHub Actions"><meta name=twitter:description content="Let me show you how to automate publishing a DocFX documentation page using GitHub Actions"><meta name=application-name content="TehGM"><meta name=apple-mobile-web-app-title content="TehGM"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://tehgm.net/blog/docfx-github-actions/><link rel=prev href=https://tehgm.net/blog/discordnet-regex-commands/><link rel=next href=https://tehgm.net/blog/nuget-github-actions/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"DocFX automation with GitHub Actions","inLanguage":"en-gb","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/tehgm.net\/blog\/docfx-github-actions\/"},"image":["https:\/\/tehgm.net\/img\/tehgm_avatar.png"],"genre":"blog","keywords":"guide, dev, web","wordcount":1751,"url":"https:\/\/tehgm.net\/blog\/docfx-github-actions\/","datePublished":"2020-12-18T17:44:02+01:00","dateModified":"2020-12-18T17:44:02+01:00","publisher":{"@type":"Organization","name":"TehGM"},"author":{"@type":"Person","name":"TehGM"},"description":"Let me show you how to automate publishing a DocFX documentation page using GitHub Actions"}</script></head><body header-desktop header-mobile><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('dark'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'dark'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=TehGM><span id=id-1 class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/ title=Home>Home </a><a class=menu-item href=/blog/ title=Blog>Blog </a><a class=menu-item href=/blog/imo/ title="Blog: IMO">IMO </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=TehGM><span id=id-2 class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/ title=Home>Home</a><a class=menu-item href=/blog/ title=Blog>Blog</a><a class=menu-item href=/blog/imo/ title="Blog: IMO">IMO</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">DocFX automation with GitHub Actions</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://tehgm.net title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw"></i>TehGM</a></span>&nbsp;<span class=post-category>included in <a href=/blog/categories/technology/><i class="far fa-folder fa-fw"></i>Technology</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=18.12.2020>18.12.2020</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1751 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;9 minutes&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#what-is-docfx>What is DocFX?</a></li><li><a href=#what-are-github-actions>What are GitHub Actions</a></li><li><a href=#creating-a-docfx-action>Creating a DocFX Action</a><ul><li><a href=#requirements>Requirements</a></li><li><a href=#creating-an-action-file>Creating an Action file</a></li><li><a href=#checking-the-action-out>Checking the action out</a></li><li><a href=#viewing-the-documentation>Viewing the documentation</a></li></ul></li><li><a href=#summary>Summary</a></li></ul></nav></div></div><div class=content id=content><p>Publishing a DocFX page manually each time you change it is yet another tedious step that would need to be performed during release. Recently I was releasing v1.0.0 of my <a href=https://github.com/TehGM/Wolfringo target=_blank rel="noopener noreffer">Wolfringo</a> library, and I set up automated publishing using GitHub Actions!</p><h2 id=what-is-docfx>What is DocFX?</h2><p><a href=https://dotnet.github.io/docfx/ target=_blank rel="noopener noreffer">DocFX</a> is a static page generator that generates HTML from Markdown files. What differentiates it from generators like <a href=https://tehgm.net/blog/wordpress-to-hugo/ rel>Hugo</a> or Jekyll is that it&rsquo;s designed specifically for code documentation, and as such, it generates API Reference from comments in the source code of your project. Neat, huh?</p><p>DocFX promises to support multiple languages, including C#, F#, Visual Basic, REST, JavaScript, Java, Python and TypeScript</p><p>DocFX is maintained by Microsoft - in fact, I believe <a href=https://docs.microsoft.com target=_blank rel="noopener noreffer">Microsoft Docs</a> are also largely generated with DocFX.</p><h2 id=what-are-github-actions>What are GitHub Actions</h2><p><a href=https://github.com/features/actions target=_blank rel="noopener noreffer">GitHub Actions</a> are CI/CD workflows that are integrated directly into your GitHub repository. They can be ran manually or automatically on certain events (such as push to a branch or a Pull Request being opened). If Action is triggered by a Pull Request, GitHub will automatically start the action, and will prevent merging the PR until all actions are successful (unless you&rsquo;re an admin on the repository - then you can force merge).</p><p>GitHub Actions are free to use for public repositiories.</p><p>I find GitHub Actions really useful for automatically publishing websites from source, such as Hugo or DocFX projects. Publishing Hugo I deeply covered in my post about <a href=https://tehgm.net/blog/wordpress-to-hugo/#automatic-deployment rel>Migrating this page from Wordpress to Hugo</a>, so let&rsquo;s focus on DocFX here!</p><h2 id=creating-a-docfx-action>Creating a DocFX Action</h2><p>There&rsquo;s an existing <a href=https://github.com/marketplace/actions/docfx-action target=_blank rel="noopener noreffer">docfx-action</a> by <em><a href=https://github.com/nikeee target=_blank rel="noopener noreffer">nikeee</a></em>, however I had an issue getting it to work with my .NET Core/.NET Standard project - I assume it&rsquo;d be because that action uses Mono under the hood. After trying to get it to work for a longer while, I decided to write my own action that handles DocFX.</p><h3 id=requirements>Requirements</h3><p>I assume that you already have your DocFX files set up, and your project code ready and commented with <code>///</code> comments. Writing these is a larger topic and out of scope of this blog post - if you need help, please refer to <a href=https://dotnet.github.io/docfx/tutorial/docfx_getting_started.html target=_blank rel="noopener noreffer">DocFX tutorials</a> and <a href=https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/xmldoc/ target=_blank rel="noopener noreffer">XML documentation comments guide</a>.</p><p>I also recommend that you work on minimum 2 branches with your project - master and dev. While this isn&rsquo;t strictly required for your DocFX action to work, but working on dev and pushing to master only for release can be used to limit your documentation re-publishing to only when a release is actually ready. Plus, not working on a master branch directly is considered to be a good practice anyway.</p><div class="details admonition example open"><div class="details-summary admonition-title"><i class="icon fas fa-list-ol fa-fw"></i>Examples<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>If you&rsquo;d like to see live examples, don&rsquo;t worry, I have these.<br><a href=https://github.com/TehGM/Wolfringo/blob/master/Wolfringo.Core/IWolfClient.cs target=_blank rel="noopener noreffer">Wolfringo - IWolfClient.cs</a> - source code example.<br><a href=https://github.com/TehGM/Wolfringo/tree/master/docs target=_blank rel="noopener noreffer">Wolfringo - docs folder</a> - documentation config and additional Markdown files.</div></div></div><h3 id=creating-an-action-file>Creating an Action file</h3><p>Actions are configured as .yml files, and reside in <code>.github/workflows/</code> directory in your repository. You can create the file manually, but let&rsquo;s use GitHub menus to create the file in a correct location for us. In your repository, press <strong>Actions</strong> button. GitHub automatically suggests some pre-defined Actions templates, but for this tutorial, let&rsquo;s click <em>set up a workflow yourself</em> link.</p><a class=lightgallery href=/blog/docfx-github-actions/screenshot-creating-action-1.png title=/blog/docfx-github-actions/screenshot-creating-action-1.png data-thumbnail=/blog/docfx-github-actions/screenshot-creating-action-1.png><img class=lazyload src=/svg/loading.min.svg data-src=screenshot-creating-action-1.png data-srcset="/blog/docfx-github-actions/screenshot-creating-action-1.png, screenshot-creating-action-1.png 1.5x, /blog/docfx-github-actions/screenshot-creating-action-1.png 2x" data-sizes=auto alt=/blog/docfx-github-actions/screenshot-creating-action-1.png></a><p>GitHub will display a template for a default workflow - you are welcome to edit it, or remove everything and start fresh.</p><h4 id=naming-your-action>Naming your action</h4><p>Your action needs a name - you can name it whatever you want, but I suggest using a name that will help you understand what the action does just from the name alone.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>name</span><span class=p>:</span><span class=w> </span>DocFX<span class=w> </span>Build<span class=w> </span>and<span class=w> </span>Publish</code></pre></td></tr></table></div></div><p>You probably want to rename the .yml file as well:
<a class=lightgallery href=/blog/docfx-github-actions/screenshot-naming-action-1.png title=/blog/docfx-github-actions/screenshot-naming-action-1.png data-thumbnail=/blog/docfx-github-actions/screenshot-naming-action-1.png><img class=lazyload src=/svg/loading.min.svg data-src=screenshot-naming-action-1.png data-srcset="/blog/docfx-github-actions/screenshot-naming-action-1.png, screenshot-naming-action-1.png 1.5x, /blog/docfx-github-actions/screenshot-naming-action-1.png 2x" data-sizes=auto alt=/blog/docfx-github-actions/screenshot-naming-action-1.png></a></p><h4 id=selecting-when-to-run>Selecting when to run</h4><p>Actions can be triggered by numerous events. In our example, we&rsquo;ll enable it for pushes and Pull Requests to master branch.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>on</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>push</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span>master<span class=w> </span><span class=p>]</span><span class=w>
</span><span class=w>  </span><span class=k>pull_request</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span>master<span class=w> </span><span class=p>]</span></code></pre></td></tr></table></div></div></p><p>Of course you can use any event you want - see <a href=https://docs.github.com/en/free-pro-team@latest/actions/reference/events-that-trigger-workflows target=_blank rel="noopener noreffer">Events that Trigger Workflows</a> for a list. You can also specify more branches in the array than just master.</p><h4 id=creating-a-job>Creating a job</h4><p>GitHub Actions can have multiple <a href=https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-syntax-for-github-actions#jobs target=_blank rel="noopener noreffer">jobs</a> running in parallel, or one after another if you use <a href=https://docs.github.com/en/free-pro-team@latest/actions/reference/workflow-syntax-for-github-actions#jobsjob_idneeds target=_blank rel="noopener noreffer">needs</a> option. For our example, we&rsquo;ll use just one job - let&rsquo;s name it <code>generate-docs</code>.</p><p>We&rsquo;ll set the job to run on Windows virtual machine - this is most sure way to get it working. There could be way to run DocFX on a Linux virtual machine, but I am not sure if it&rsquo;ll cause issues (due to Mono etc).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>jobs</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>generate-docs</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>runs-on</span><span class=p>:</span><span class=w> </span>windows-latest</code></pre></td></tr></table></div></div><h4 id=steps>Steps</h4><p>GitHub Action job runs in steps, which always run one after another. This way, we can get everything installed etc before we build the page and publish it.<br>All steps should be inside of our job object.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=hl><span class=lnt>13
</span></span><span class=hl><span class=lnt>14
</span></span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>jobs</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>generate-docs</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>runs-on</span><span class=p>:</span><span class=w> </span>windows-latest<span class=w>
</span><span class=w>
</span><span class=hl><span class=w>    </span><span class=k>steps</span><span class=p>:</span><span class=w>
</span></span><span class=hl><span class=w>      </span><span class=c># all steps go here</span></span></code></pre></td></tr></table></div></div><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw"></i>Language-dependent steps<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>In this tutorial, I use .NET Core as an example. If you use non-.NET Core language, <a href=#step-2---install-net-core rel>Step 2</a> and <a href=#step-4---install-dependencies rel>Step 4</a> might be different.</div></div></div><h5 id=step-1---checkout>Step 1 - Checkout</h5><p>The first step is to get all of our project code onto virtual machine. This is easy to do using predefined <a href=https://github.com/actions/checkout target=_blank rel="noopener noreffer">checkout action</a>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>13
</span><span class=hl><span class=lnt>14
</span></span><span class=hl><span class=lnt>15
</span></span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>    </span><span class=k>steps</span><span class=p>:</span><span class=w>
</span><span class=hl><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Checkout<span class=w>
</span></span><span class=hl><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>actions/checkout@v2</span></code></pre></td></tr></table></div></div><h5 id=step-2---install-net-core>Step 2 - Install .NET Core</h5><p>The 2nd step is to install .NET Core, so DocFX can build our project. Luckily there is already a predefined action for that called <a href=https://github.com/actions/setup-dotnet target=_blank rel="noopener noreffer">setup-dotnet</a>, so we don&rsquo;t have to run series of commands.<br>This action can specify which .NET Core version to install. For this example, I chose version <em>3.1.101</em>. You can pick whichever version you need with your project, or even a wildcard - refer to <a href=https://github.com/actions/setup-dotnet target=_blank rel="noopener noreffer">setup-dotnet</a> action readme.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Setup<span class=w> </span>.NET<span class=w> </span>Core<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>actions/setup-dotnet@v1<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>dotnet-version</span><span class=p>:</span><span class=w> </span><span class=m>3.1.101</span></code></pre></td></tr></table></div></div><h5 id=step-3---install-docfx>Step 3 - Install DocFX</h5><p>Next step is to install DocFX. The easiest way to install it in a Windows environment is using <a href=https://chocolatey.org/ target=_blank rel="noopener noreffer">Chocolatey</a>. We&rsquo;re lucky again with this one - there is already an action <a href=https://github.com/crazy-max/ghaction-chocolatey target=_blank rel="noopener noreffer">ghaction-chocolatey</a> created by <em><a href=https://github.com/crazy-max target=_blank rel="noopener noreffer">crazy-max</a></em> that makes using this package really easy to use with GitHub Actions.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Setup<span class=w> </span>DocFX<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>crazy-max/ghaction-chocolatey@v1<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>args</span><span class=p>:</span><span class=w> </span>install<span class=w> </span>docfx</code></pre></td></tr></table></div></div><h5 id=step-4---install-dependencies>Step 4 - Install dependencies</h5><p>Now we have all software installed. Time to install all NuGet packages that our projects use. If we don&rsquo;t do this, there might be issues generating some cross-links for your automatically generated API Reference. For example, I had issues with any links to methods that take <code>CancellationToken</code> as one of their parameters.<br>To install dependencies, we simply run <code>dotnet restore</code> command in the step:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Install<span class=w> </span>dependencies<span class=w>
</span><span class=w>        </span><span class=k>run</span><span class=p>:</span><span class=w> </span>dotnet<span class=w> </span>restore</code></pre></td></tr></table></div></div></p><h5 id=step-5---build-documentation-page>Step 5 - Build documentation page</h5><p>Now that we have everything installed and our project prepared, we can finally build our documentation HTML. To do so, we run <code>docfx docfx.json</code> command.<br>In this step, I also change working directory to <em>docs</em> folder. This might be not needed or the folder might be named differently depending on your project structure - just point to the folder that contains your <em>docfx.json</em> file.<br>Additionally, I also explicitly tell GitHub to not run next steps if this one fails - we don&rsquo;t want to publish broken documentation website. GitHub should act this way by default, but by specifying this explicitly, we know for sure that it&rsquo;ll work exactly how we want it to.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>DocFX<span class=w> </span>Build<span class=w>
</span><span class=w>        </span><span class=k>working-directory</span><span class=p>:</span><span class=w> </span>docs<span class=w>
</span><span class=w>        </span><span class=k>run</span><span class=p>:</span><span class=w> </span>docfx<span class=w> </span>docfx.json<span class=w>
</span><span class=w>        </span><span class=k>continue-on-error</span><span class=p>:</span><span class=w> </span><span class=kc>false</span></code></pre></td></tr></table></div></div></p><h5 id=step-6---publish>Step 6 - Publish</h5><p>We&rsquo;re almost there. The last step is to actually publish the documentation website so it can be seen by everyone. To simplify this task, I use action <a href=https://github.com/peaceiris/actions-gh-pages target=_blank rel="noopener noreffer">actions-gh-pages</a> by <em><a href=https://github.com/peaceiris target=_blank rel="noopener noreffer">peaceiris</a></em>. We tell it to publish contents of <code>docs/_site</code> folder (_site is default folder for DocFX - but if you changed it in <em>docfx.json</em>, you can change that value).<br>I also use <code>force_orphan</code> option - this will ensure that <code>gh-pages</code> branch has no history, and no redundant files.<br>An <code>if</code> property plays important role in this step - it ensures that this step is skipped for anything that isn&rsquo;t a push to master branch. This enhances security of our documentation website by preventing anyone overwriting it by opening a Pull Request. This also ensures that documentation is only updated when changes are released to master branch - and won&rsquo;t keep changing for features that are still WIP.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Publish<span class=w>
</span><span class=w>        </span><span class=k>if</span><span class=p>:</span><span class=w> </span>github.event_name<span class=w> </span>==<span class=w> </span><span class=s1>&#39;push&#39;</span><span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>peaceiris/actions-gh-pages@v3<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>github_token</span><span class=p>:</span><span class=w> </span>${{<span class=w> </span>secrets.GITHUB_TOKEN<span class=w> </span>}}<span class=w>
</span><span class=w>          </span><span class=k>publish_dir</span><span class=p>:</span><span class=w> </span>docs/_site<span class=w>
</span><span class=w>          </span><span class=k>force_orphan</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></code></pre></td></tr></table></div></div></p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw"></i>Tip<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><p>If you want to use a custom domain, you can also add <code>cname</code> to <code>with</code>. Use your domain as the value.</p><p>View <a href=https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site target=_blank rel="noopener noreffer">GitHub Docs</a> for more information on using custom domains on GitHub Pages.</p></div></div></div><h4 id=saving-action>Saving action</h4><p>Yay, we have all steps prepared. The entire action should look more or less like this:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-yaml data-lang=yaml><span class=k>name</span><span class=p>:</span><span class=w> </span>DocFX<span class=w> </span>Build<span class=w> </span>and<span class=w> </span>Publish<span class=w>
</span><span class=w>
</span><span class=w></span><span class=k>on</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>push</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span>master<span class=w> </span><span class=p>]</span><span class=w>
</span><span class=w>  </span><span class=k>pull_request</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>branches</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span>master<span class=w> </span><span class=p>]</span><span class=w>
</span><span class=w>    
</span><span class=w></span><span class=k>jobs</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>generate-docs</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>runs-on</span><span class=p>:</span><span class=w> </span>windows-latest<span class=w>
</span><span class=w>
</span><span class=w>    </span><span class=k>steps</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Checkout<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>actions/checkout@v2<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Setup<span class=w> </span>.NET<span class=w> </span>Core<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>actions/setup-dotnet@v1<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>dotnet-version</span><span class=p>:</span><span class=w> </span><span class=m>3.1.101</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Setup<span class=w> </span>DocFX<span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>crazy-max/ghaction-chocolatey@v1<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>args</span><span class=p>:</span><span class=w> </span>install<span class=w> </span>docfx<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Install<span class=w> </span>dependencies<span class=w>
</span><span class=w>        </span><span class=k>run</span><span class=p>:</span><span class=w> </span>dotnet<span class=w> </span>restore<span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>DocFX<span class=w> </span>Build<span class=w>
</span><span class=w>        </span><span class=k>working-directory</span><span class=p>:</span><span class=w> </span>docs<span class=w>
</span><span class=w>        </span><span class=k>run</span><span class=p>:</span><span class=w> </span>docfx<span class=w> </span>docfx.json<span class=w>
</span><span class=w>        </span><span class=k>continue-on-error</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span><span class=w>      </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>Publish<span class=w>
</span><span class=w>        </span><span class=k>if</span><span class=p>:</span><span class=w> </span>github.event_name<span class=w> </span>==<span class=w> </span><span class=s1>&#39;push&#39;</span><span class=w>
</span><span class=w>        </span><span class=k>uses</span><span class=p>:</span><span class=w> </span>peaceiris/actions-gh-pages@v3<span class=w>
</span><span class=w>        </span><span class=k>with</span><span class=p>:</span><span class=w>
</span><span class=w>          </span><span class=k>github_token</span><span class=p>:</span><span class=w> </span>${{<span class=w> </span>secrets.GITHUB_TOKEN<span class=w> </span>}}<span class=w>
</span><span class=w>          </span><span class=k>publish_dir</span><span class=p>:</span><span class=w> </span>docs/_site<span class=w>
</span><span class=w>          </span><span class=k>force_orphan</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></code></pre></td></tr></table></div></div></p><p>Now go ahead, and press <strong>Start commit</strong>. You can name your commit, and select whether it should be commited directly to master, or started as a pull request.
<a class=lightgallery href=/blog/docfx-github-actions/screenshot-saving-action-1.png title=/blog/docfx-github-actions/screenshot-saving-action-1.png data-thumbnail=/blog/docfx-github-actions/screenshot-saving-action-1.png><img class=lazyload src=/svg/loading.min.svg data-src=screenshot-saving-action-1.png data-srcset="/blog/docfx-github-actions/screenshot-saving-action-1.png, screenshot-saving-action-1.png 1.5x, /blog/docfx-github-actions/screenshot-saving-action-1.png 2x" data-sizes=auto alt=/blog/docfx-github-actions/screenshot-saving-action-1.png></a></p><h3 id=checking-the-action-out>Checking the action out</h3><p>Whether you commit directly or create a pull request, if you didn&rsquo;t change events when <a href=#selecting-when-to-run rel>selecting when to run</a>, the action should automatically start. The only difference will be that Pull Request will not publish the built documentation page, due to the constraint we set in last step.</p><p>You can view your actions progress in <strong>Actions</strong> tab in your repository. You can click on the workflow result name to check the progress.<figure><a class=lightgallery href=/blog/docfx-github-actions/screenshot-running-action-1.png title=/blog/docfx-github-actions/screenshot-running-action-1.png data-thumbnail=/blog/docfx-github-actions/screenshot-running-action-1.png data-sub-html="<h2>Example from Wolfringo - with a slightly more complex setup</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=screenshot-running-action-1.png data-srcset="/blog/docfx-github-actions/screenshot-running-action-1.png, screenshot-running-action-1.png 1.5x, /blog/docfx-github-actions/screenshot-running-action-1.png 2x" data-sizes=auto alt=/blog/docfx-github-actions/screenshot-running-action-1.png></a><figcaption class=image-caption>Example from Wolfringo - with a slightly more complex setup</figcaption></figure></p><p>You can view steps and their output as it goes. If your action skips publishing due to it not being a push to master, <em>Publish</em> step will have a skipped symbol:<figure><a class=lightgallery href=/blog/docfx-github-actions/screenshot-running-action-2.png title=/blog/docfx-github-actions/screenshot-running-action-2.png data-thumbnail=/blog/docfx-github-actions/screenshot-running-action-2.png data-sub-html="<h2>Example from Wolfringo - Publish action was skipped</h2>"><img class=lazyload src=/svg/loading.min.svg data-src=screenshot-running-action-2.png data-srcset="/blog/docfx-github-actions/screenshot-running-action-2.png, screenshot-running-action-2.png 1.5x, /blog/docfx-github-actions/screenshot-running-action-2.png 2x" data-sizes=auto alt=/blog/docfx-github-actions/screenshot-running-action-2.png></a><figcaption class=image-caption>Example from Wolfringo - Publish action was skipped</figcaption></figure></p><h3 id=viewing-the-documentation>Viewing the documentation</h3><p>Once all steps finish successfuly, if Publishing wasn&rsquo;t skipped, you should see your documentation on <code>your-gh-username.github.io/repository-name</code>.</p><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw"></i>Custom domain<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><p>If you set custom CNAME in Publish step, your website will be seen at that domain. For example, if your CNAME is set to <code>my.domain.com</code>, instead of <code>your-gh-username.github.io/repository-name</code>, your documentation will be viewable under <code>my.domain.com</code>.</p><p>View <a href=https://docs.github.com/en/free-pro-team@latest/github/working-with-github-pages/configuring-a-custom-domain-for-your-github-pages-site target=_blank rel="noopener noreffer">GitHub Docs</a> for more information on using custom domains on GitHub Pages.</p></div></div></div><h2 id=summary>Summary</h2><p>You should now know how to automate your DocFX documentation publishing with GitHub Pages. It&rsquo;s a great way to reduce that manual step for all your future development and all documentation changes - you can focus on coding and writing guides instead!</p><p>Of course, both GitHub Actions and GitHub Pages can be used for a wide variety of other use cases as well - don&rsquo;t stop exploring!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 18.12.2020</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://tehgm.net/blog/docfx-github-actions/ data-title="DocFX automation with GitHub Actions" data-via=TehOriginalGM data-hashtags=guide,dev,web><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://tehgm.net/blog/docfx-github-actions/ data-hashtag=guide><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://tehgm.net/blog/docfx-github-actions/ data-title="DocFX automation with GitHub Actions" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=javascript:void(0); title="Share on Tumblr" data-sharer=tumblr data-url=https://tehgm.net/blog/docfx-github-actions/ data-title="DocFX automation with GitHub Actions" data-caption="Let me show you how to automate publishing a DocFX documentation page using GitHub Actions" data-tags=guide,dev,web><i class="fab fa-tumblr fa-fw"></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://tehgm.net/blog/docfx-github-actions/ data-title="DocFX automation with GitHub Actions"><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://tehgm.net/blog/docfx-github-actions/><i class="fab fa-reddit fa-fw"></i></a><a href=javascript:void(0); title="Share on Myspace" data-sharer=myspace data-url=https://tehgm.net/blog/docfx-github-actions/ data-title="DocFX automation with GitHub Actions" data-description="Let me show you how to automate publishing a DocFX documentation page using GitHub Actions"><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/blog/tags/guide/>guide</a>,&nbsp;<a href=/blog/tags/dev/>dev</a>,&nbsp;<a href=/blog/tags/web/>web</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/blog/discordnet-regex-commands/ class=prev rel=prev title="Adding Regex Commands to Discord.Net's Command System"><i class="fas fa-angle-left fa-fw"></i>Adding Regex Commands to Discord.Net's Command System</a>
<a href=/blog/nuget-github-actions/ class=next rel=next title="Publishing NuGet packages with GitHub Actions">Publishing NuGet packages with GitHub Actions<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://tehgm.net>TehGM</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><link rel=stylesheet href=/lib/lightgallery/lightgallery.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/lightgallery/lightgallery.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-thumbnail.min.js></script><script type=text/javascript src=/lib/lightgallery/lg-zoom.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=https://code.jquery.com/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/spoiler.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{},"data":{"id-1":"TehGM","id-2":"TehGM"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"typeit":{"cursorChar":null,"cursorSpeed":null,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":null,"speed":null}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>